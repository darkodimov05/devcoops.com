I"ý<p>Accidental deletion of files can happen to anyone working either on-premise or in the cloud. As a DevOps engineer who is responsible for managing access permissions to resources, the principle of least privilege is a must, which means limiting people and services access to bare minimum so they can perform their work. But, sometimes even if we want to protect the files as much as possible, a human error could happen. Thatâ€™s where <strong>Soft delete</strong> can be useful.</p>

<h2 id="what-is-soft-delete">What is <strong>Soft delete</strong></h2>
<p><strong>Soft delete</strong> is an Azure Storage blob feature which can help you recover your accidental deleted blob objects by an application or storage account users. Currently, itâ€™s available to blob storage only including hot, cool and archive storage tiers.</p>

<h2 id="how-it-works">How it works</h2>
<p>When data is deleted, the blob object transition to a soft deleted state instead of being permanently removed. And everytime when object is overwritten, a soft delete snapshot is generated in order to save the state of the overwritten object.<br />
<img src="/assets/images/screenshots/screenshot19.png" alt="Blob Service diagram" /><br />
The recoverable time is configurable with maximum of one year. It is backward compatible which means you donâ€™t have to make any changes in the application code in order yo user it. It is billed at the same rate as active data.</p>

<h2 id="prerequisites">Prerequisites</h2>
<ul>
  <li>Azure account</li>
  <li>Azure storage account</li>
</ul>

<p>{% include in-article-ad.html %}</p>

<h2 id="enable-soft-delete-feature">Enable Soft delete feature</h2>
<p><strong>Step 1</strong>. Login to the Azure Portal and go to the Storage account.</p>

<p><strong>Step 2</strong>. Open the <strong>Blobs</strong> services and create a storage container.</p>

<p><strong>Step 3</strong>. Under <strong>Blob service</strong> click <em>Soft delete</em>.<br />
<img src="/assets/images/screenshots/screenshot13.png" alt="Blob Service options" /></p>

<p><strong>Step 4</strong>. Turn on the <em>Soft delete</em> feature.<br />
<img src="/assets/images/screenshots/screenshot14.png" alt="Soft delete" /></p>

<p><strong>Note</strong>: There is a retention policies that indicates the period of time that soft deleted data could be stored and available for recovery from 1 day to maximum 365 days. Also, when you create new storage account the <em>soft delete</em> feature is off by default.</p>

<p><strong>Step 5</strong>. Leave the default retention policy to 7 days, and click <strong>Save</strong>.</p>

<p><strong>Step 6</strong>. Go to the blob container and upload a test file.</p>

<h2 id="test-soft-delete-feature">Test <em>Soft delete</em> feature</h2>

<p><strong>Step 7</strong>. Select the file and remove it.
<img src="/assets/images/screenshots/screenshot15.png" alt="Remove blob object" /></p>

<p><strong>Step 8</strong>. Now check the <em>Show deleted blobs</em> option. It will list the deleted file with a status <strong>Deleted</strong>.
<img src="/assets/images/screenshots/screenshot16.png" alt="List deleted blob object" /></p>

<p><strong>Step 9</strong>. Click on the file. It will open a new window, click the <strong>Undelete</strong> button.
<img src="/assets/images/screenshots/screenshot17.png" alt="List deleted blob object" /></p>

<p><strong>Step 10</strong>. Go back to the blob container, it will list the file with status <strong>Active</strong>.
<img src="/assets/images/screenshots/screenshot18.png" alt="List deleted blob object" /></p>

<h2 id="conclusion">Conclusion</h2>
<p>Enabling <strong>Soft delete</strong> will save you a lot of time, instead of recovering from backups. I think itâ€™s a nice feature to have in development environment. And for staging and production environments, make sure you configure the proper data redundancy option and backup strategy.</p>

<p>Official documentation: <a href="https://docs.microsoft.com/en-us/azure/storage/blobs/storage-blob-soft-delete" target="_blank">Soft delete for Azure Storage Blobs</a>.</p>
:ET