I"à<p>As we know Nginx has a lot of great features, one of them is to redirect your website from <code class="language-plaintext highlighter-rouge">http</code> to <code class="language-plaintext highlighter-rouge">https</code>. Using https is more secure which means that the communication between the client and the server is encrypted in both directions. Redirecting the traffic from <code class="language-plaintext highlighter-rouge">http</code> to <code class="language-plaintext highlighter-rouge">https</code> is the most common task if you are working as a DevOps or System Administrator. Nginx as a reverse proxy web server offers a lot of redirect rules but in this tutorial, we will take a look at the few of them.</p>

<h2 id="prerequisites">Prerequisites</h2>
<ul>
  <li>Already installed <a href="https://devcoops.com/how-to-install-nginx-on-ubuntu18.04/">nginx web server</a></li>
  <li>Make sure that you are logged into your Linux server as a user with <code class="language-plaintext highlighter-rouge">sudo</code> privileges</li>
</ul>

<p>{% include in-article-ad.html %}</p>

<h2 id="redirect-all-to-https">Redirect all to HTTPS</h2>
<p>The easiest and the most common method is to redirect all the 80(HTTP) requests to 443(HTTPS).
To enable this you can copy and paste the following configuration:</p>
<div class="language-nginx highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">server</span> <span class="p">{</span>
    <span class="kn">listen</span> <span class="mi">80</span> <span class="s">default_server</span><span class="p">;</span>
    <span class="kn">server_name</span> <span class="s">your-domain.com</span><span class="p">;</span>
    <span class="kn">return</span> <span class="mi">301</span> <span class="s">https://</span><span class="nv">$host$request_uri</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>
<p>This server block listens and accepting the requests on the port 80 default server. The <code class="language-plaintext highlighter-rouge">server_name</code> should match your domain name and finally the last line is returning a 301 redirect to the <code class="language-plaintext highlighter-rouge">https</code> block of whatever URI is requested.</p>

<h2 id="redirecting-specific-sites">Redirecting specific sites</h2>
<p>If you have multiple sites and not all of them have SSL certificate, Nginx allows you to redirect only specific sites. To do that you should copy and paste the following configuration:</p>
<div class="language-nginx highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">server</span> <span class="p">{</span>
    <span class="kn">listen</span> <span class="mi">80</span> <span class="s">default_server</span><span class="p">;</span>
    <span class="kn">server_name</span> <span class="s">your-domain.com</span><span class="p">;</span>
    <span class="kn">return</span> <span class="mi">301</span> <span class="s">https://your-domain.com</span><span class="nv">$request_uri</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>
<p>This server block listens and accepting the requests only on the port 80. Also it is only listening for the requests made to the your-domain.com. And the last line returns 301 redirect to the <code class="language-plaintext highlighter-rouge">https</code> only for the hostname your-domain.com</p>

<h2 id="https-redirect-www-to-non-www">Https redirect www to non-www</h2>
<p>First to set up this redirect on your domain please make sure that you have a valid <code class="language-plaintext highlighter-rouge">www</code> DNS record in your nameservers. If you donâ€™t have you can create one, copy and paste the following lines into your nginx configuration file:</p>
<div class="language-nginx highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">server</span> <span class="p">{</span>
    <span class="kn">server_name</span> <span class="s">www.your-domain.com</span><span class="p">;</span>
    <span class="kn">return</span> <span class="mi">301</span> <span class="nv">$scheme</span><span class="p">:</span><span class="n">//your-domain.com</span><span class="nv">$request_uri</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>
<p>This tells nginx to redirect requests from <code class="language-plaintext highlighter-rouge">www.your-domain.com</code> to <code class="language-plaintext highlighter-rouge">your-domain.com</code>. So donâ€™t forget to execute:</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">sudo </span>systemctl reload nginx
</code></pre></div></div>
<p>to put the changes into effect for all the above redirects.</p>

<h2 id="redirect-an-existing-uri-to-a-new-one">Redirect an existing URI to a new one</h2>
<p>To redirect a specific URI of your domain the best practise is to create a <code class="language-plaintext highlighter-rouge">location</code> block. To make this work put the following configuration into your nginx conf file:</p>
<div class="language-nginx highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">location</span> <span class="p">~</span><span class="sr">*</span> <span class="s">"^/some-specific-uri.html"</span> <span class="p">{</span>
    <span class="kn">return</span> <span class="mi">301</span> <span class="s">https://your-domain.com/the-desired-redirect-uri.html</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>
<p>The above configuration will match all the requests that conatains <code class="language-plaintext highlighter-rouge">some-specific-uri.html</code> in the URL and redirect them to the <code class="language-plaintext highlighter-rouge">https://your-domain.com/the-desired-redirect-uri.html</code>.</p>

<h2 id="conclusion">Conclusion</h2>
<p>In this tutorial we shown you a few most common redirects that will help you to manage your domain. If you like this tutorial please comment bellow or share it.</p>
:ET