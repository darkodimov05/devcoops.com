I"Ê<p>Azure DNS is a cloud-based DNS hosting service that allows you to host and manage your own domains. These domains are hosted on Azureâ€™s global network of DNS name servers. Keep in mind that you canâ€™t buy a domain name from Azure DNS, instead you can use the <a href="https://docs.microsoft.com/en-gb/azure/app-service/manage-custom-dns-buy-domain#buy-the-domain" target="_blank">App Service domains</a>, or a third-party domain registrar like: GoDaddy, Namecheap, AWS Route53, Google Cloud DNS, and so on. If you already an owner of a public DNS zone, you could just configure the name servers NS records to point to those of Azure. So, why bother hosting on Azure DNS over other domain registrars?!</p>

<p>First of all, it could be difficult to manage many public DNS zones using a graphical interface, and every DNS provider have itâ€™s own GUI, which sometimes could be frustrating configuring each of them. This issue leads to automation. If you are working as a DevOps, Azure can help you automate DNS zones configuration by using ARM, PowerShell or Azure CLI. This means that you can manage your DNS records by using the same credentials, APIs, tools and billing as your other Azure services.</p>

<p>With Azure DNS you can create public and private DNS zones. Today, we are going to create a public DNS zone using the Azure CLI, and cover the private zones in another post.</p>

<p>Check the official documentation <a href="https://docs.microsoft.com/en-us/azure/dns/dns-overview" target="_blank">What is Azure DNS?</a></p>

<h2 id="prerequisites">Prerequisites</h2>
<ul>
  <li>Azure account</li>
  <li>Azure Storage account</li>
</ul>

<p>{% include in-article-ad.html %}</p>

<h2 id="create-a-new-public-dns-zone">Create a new public DNS zone</h2>
<p><strong>Step 1</strong>. Open <em>Terminal</em> and login to the Azure Portal:</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>az login
</code></pre></div></div>
<p>It will open a new window using the default browser where you will be prompted for email and password.</p>

<p><strong>Step 2</strong>. Create a resource group:</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>az group create <span class="nt">--name</span> <span class="s2">"public-dns-rg"</span> <span class="nt">--location</span> westeurope
</code></pre></div></div>

<p><strong>Step 3</strong>. Create a new DNS zone:</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>az network dns zone create <span class="nt">--name</span> <span class="s2">"devcoops.com"</span> <span class="nt">--resouce-group</span> <span class="s2">"public-dns-rg"</span>
</code></pre></div></div>
<p>Parameters:</p>
<ul>
  <li><code class="language-plaintext highlighter-rouge">--name</code>: name of the public DNS zone.</li>
  <li><code class="language-plaintext highlighter-rouge">--resource-group</code>: name of the resource group.</li>
</ul>

<p>Json output will output <code class="language-plaintext highlighter-rouge">nameServers</code> parameter including the NS records for the zone:</p>
<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nl">"nameServers"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="s2">"ns1-06.azure-dns.com."</span><span class="p">,</span><span class="w">
    </span><span class="s2">"ns2-06.azure-dns.net."</span><span class="p">,</span><span class="w">
    </span><span class="s2">"ns3-06.azure-dns.org."</span><span class="p">,</span><span class="w">
    </span><span class="s2">"ns4-06.azure-dns.info."</span><span class="w">
  </span><span class="p">]</span><span class="w">
</span></code></pre></div></div>
<p><strong>Note</strong>: You can also list the NS records using the command:</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>az network dns record-set ns show <span class="nt">--name</span> @ <span class="nt">--zone</span> <span class="s2">"devcoops.com"</span> <span class="nt">--resource-group</span> <span class="s2">"public-dns-rg"</span>
</code></pre></div></div>

<h2 id="create-a-dns-record">Create a DNS record</h2>
<p><strong>Step 4</strong>. Now that you have a public DNS zone, create a new DNS record:</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>az network dns record-set a add-record <span class="nt">--record-set-name</span> <span class="s2">"test"</span> <span class="nt">--ipv4-address</span> 10.10.10.10 <span class="nt">--zone</span> <span class="s2">"devcoops.com"</span> <span class="nt">--resource-group</span> <span class="s2">"public-dns-rg"</span>
</code></pre></div></div>
<p>Parameters:</p>
<ul>
  <li><code class="language-plaintext highlighter-rouge">--record-set-name</code>: name of the DNS A record.</li>
  <li><code class="language-plaintext highlighter-rouge">--ipv4-address</code>: value of the DNS A record.</li>
</ul>

<p><strong>Step 5</strong>. You can also list the DNS records in the zone:</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>az network dns record-set list <span class="nt">--zone</span> <span class="s2">"devcoops.com"</span> <span class="nt">--resource-group</span> <span class="s2">"public-dns-rg"</span>
</code></pre></div></div>

<h2 id="test-the-name-resolution">Test the name resolution</h2>
<p><strong>Step 6</strong>. Open a new <em>Terminal</em> tab and run the command:</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>nslookup test.devcoops.com ns1-06.azure-dns.net.
</code></pre></div></div>
<p>Output:<br />
<img src="/assets/images/screenshots/screenshot21.png" alt="Azure CDN create profile result" /></p>

<p><strong>Note</strong>: You can also use the other 3 NS records listed under <strong>Step 3</strong>.</p>

<h2 id="cleaning-up">Cleaning up</h2>

<p><strong>Step 7</strong>. Delete the DNS A record:</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>az network dns record-set a delete <span class="nt">--name</span> <span class="s2">"test"</span> <span class="nt">--zone</span> <span class="s2">"devcoops.com"</span> <span class="nt">--resource-group</span> <span class="s2">"public-dns-rg"</span>
</code></pre></div></div>

<p><strong>Step 8</strong>. Delete the public DNS zone:</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>az network dns zone delete <span class="nt">--name</span> <span class="s2">"devcoops.com"</span> <span class="nt">--resource-group</span> <span class="s2">"public-dns-rg"</span>
</code></pre></div></div>

<p><strong>Step 9</strong>. Delete the resource group:</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>az group delete <span class="nt">--name</span> <span class="s2">"public-dns-rg"</span>
</code></pre></div></div>

<h2 id="conclusion">Conclusion</h2>
<p>If you ever plan to run your infrastructure on Azure, or if you already have infrastructure running on Azure, itâ€™s always a good practice to migrate and host your domains on Azure.</p>
:ET